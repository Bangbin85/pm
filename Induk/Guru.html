<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guru - Buku Induk</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        /* === DESAIN BARU: PANEL GURU MODERN === */
        :root {
            --primary-color: #2563eb;
            --primary-hover: #1d4ed8;
            --secondary-color: #f3f4f6;
            --text-color: #1f2937;
            --text-muted: #6b7280;
            --border-color: #e5e7eb;
            --danger-color: #ef4444;
            --success-color: #10b981;
            --sidebar-bg: #111827;
            --sidebar-link-color: #9ca3af;
            --sidebar-link-hover: #ffffff;
            --sidebar-link-active: #ffffff;
            --sidebar-active-bg: var(--primary-color);
            --white-color: #ffffff;
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --border-radius-md: 8px;
            --border-radius-lg: 12px;
            --transition-speed: 0.3s;
            --sidebar-width: 260px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', 'Poppins', sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        
        /* === HALAMAN LOGIN NEUMORPHIC === */
        .login-screen { display: flex; align-items: center; justify-content: center; min-height: 100vh; background: linear-gradient(145deg, #e2e8f0, #f8fafc); }
        #loginCard { background: #eef2f7; padding: 2.5rem 3rem; border-radius: 30px; box-shadow: 9px 9px 18px #c5cdd5, -9px -9px 18px #ffffff; width: 100%; max-width: 420px; text-align: center; animation: contentFadeIn 0.6s ease-out; border: 1px solid rgba(255, 255, 255, 0.8); }
        #loginCard h1 { font-size: 1.8rem; font-weight: 700; color: var(--text-color); margin-bottom: 0.5rem; }
        #loginCard h1 .fa-chalkboard-user { color: var(--primary-color); }
        #loginCard > p { color: var(--text-muted); margin-bottom: 2rem; }
        #loginCard .form-group { text-align: left; margin-bottom: 1.5rem; }
        #loginCard .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-muted); }
        #loginCard .form-group input { width: 100%; padding: 1rem; border: none; border-radius: 15px; background: #eef2f7; box-shadow: inset 5px 5px 10px #c5cdd5, inset -5px -5px 10px #ffffff; font-size: 1rem; color: var(--text-color); transition: box-shadow 0.3s ease; }
        #loginCard .form-group input:focus { outline: none; box-shadow: inset 7px 7px 14px #c5cdd5, inset -7px -7px 14px #ffffff; }
        #loginCard .btn { width: 100%; margin-top: 1rem; padding: 1rem; border-radius: 15px; border: none; font-size: 1rem; font-weight: 700; letter-spacing: 0.5px; transition: all 0.3s ease; cursor: pointer; box-shadow: 5px 5px 10px #c5cdd5, -5px -5px 10px #ffffff; text-decoration: none; display: inline-block; }
        #loginCard .btn:active { transform: translateY(2px); }
        #loginCard button.btn-primary { background-color: var(--primary-color); color: var(--white-color); }
        #loginCard button.btn-primary:hover { background-color: var(--primary-hover); box-shadow: 7px 7px 14px #c5cdd5, -7px -7px 14px #ffffff; }
        #loginCard button.btn-primary:active { box-shadow: inset 5px 5px 10px #1a43a1, inset -5px -5px 10px #2b77ff; }
        #loginCard a.btn-primary { margin-top: 0.75rem; background-color: #6b7280; color: var(--white-color); }
        #loginCard a.btn-primary:hover { background-color: #4b5563; }
        #loginCard a.btn-primary:active { box-shadow: inset 5px 5px 10px #3e4651, inset -5px -5px 10px #98a4b5; }
        #loginCard #errorMessage { color: var(--danger-color); margin-top: 1rem; height: 20px; font-weight: 500; }

        /* === TATA LETAK UTAMA DENGAN SIDEBAR === */
        .app-container { display: flex; }
        .sidebar { width: var(--sidebar-width); background-color: var(--sidebar-bg); color: var(--white-color); position: fixed; top: 0; left: 0; height: 100vh; display: flex; flex-direction: column; transition: width 0.3s ease; z-index: 100; }
        .main-content-wrapper { flex-grow: 1; margin-left: var(--sidebar-width); transition: margin-left 0.3s ease; }
        #pageContent { padding: 2rem; }

        /* === SIDEBAR === */
        .sidebar-header { padding: 1.5rem; text-align: center; border-bottom: 1px solid #374151; }
        .sidebar-header img { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; margin-bottom: 0.5rem; }
        .sidebar-header h2 { font-size: 1.1rem; margin: 0; font-weight: 600; white-space: nowrap; }
        .sidebar-nav { flex-grow: 1; overflow-y: auto; }
        .sidebar-nav ul { list-style: none; padding: 1rem 0; }
        .sidebar-nav a { display: flex; align-items: center; padding: 0.85rem 1.5rem; color: var(--sidebar-link-color); text-decoration: none; transition: all 0.2s ease; font-weight: 500; }
        .sidebar-nav a:hover { background-color: #374151; color: var(--sidebar-link-hover); }
        .sidebar-nav a.active { background-color: var(--sidebar-active-bg); color: var(--sidebar-link-active); font-weight: 600; }
        .sidebar-nav .icon { width: 20px; text-align: center; margin-right: 1rem; font-size: 1.1rem; }
        
        .submenu { list-style: none; padding-left: 2rem; max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .submenu.open { max-height: 500px; }
        .submenu a { padding-left: 2.5rem; font-size: 0.9rem; }
        .submenu a::before { content: 'Â»'; margin-right: 0.75rem; }

        .sidebar-footer { padding: 1.5rem; border-top: 1px solid #374151; }
        #logoutBtn { width: 100%; }

        /* === KONTEN UTAMA === */
        .page-section { display: none; }
        .page-section.active { display: block; animation: contentFadeIn 0.5s ease; }
        @keyframes contentFadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        
        .header-container { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1.5rem; background-color: var(--white-color); padding: 1rem 2rem; border-radius: var(--border-radius-lg); box-shadow: var(--shadow-md); margin-bottom: 2rem; }
        .header-container h1 { font-size: 1.5rem; margin: 0; display: flex; align-items: center; gap: 0.75rem; }
        .header-container .fa-solid { color: var(--primary-color); }
        .header-controls { display: flex; align-items: center; gap: 1.5rem; flex-wrap: wrap; }
        .year-selector label { font-weight: 600; }
        #welcomeMessage { font-weight: 500; color: var(--text-muted); }

        .card { background: var(--white-color); padding: 2rem; border-radius: var(--border-radius-lg); box-shadow: var(--shadow-md); margin-bottom: 2rem; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border-color); }
        .card-header h3 { margin: 0; font-size: 1.25rem; }

        /* === TOMBOL & TABEL === */
        .btn { padding: 0.7rem 1.25rem; border: none; border-radius: var(--border-radius-md); cursor: pointer; font-size: 0.9rem; font-weight: 600; display: inline-flex; align-items: center; gap: 0.5rem; transition: all var(--transition-speed) ease; }
        .btn:active { transform: translateY(2px); }
        .btn-primary { background-color: var(--primary-color); color: var(--white-color); }
        .btn-primary:hover { background-color: var(--primary-hover); }
        .btn-secondary { background-color: #6b7280; color: var(--white-color); }
        .btn-secondary:hover { background-color: #4b5563; }
        .btn-outline { background: var(--white-color); color: var(--text-color); border: 1px solid var(--border-color); }
        .btn-outline:hover { background: var(--secondary-color); border-color: #d1d5db; }

        .table-wrapper { overflow-x: auto; border: 1px solid var(--border-color); border-radius: var(--border-radius-md); max-height: 70vh; }
        table { width: 100%; border-collapse: collapse; white-space: nowrap; }
        th, td { padding: 0.75rem 1rem; text-align: left; border-bottom: 1px solid var(--border-color); vertical-align: middle; }
        thead th { font-weight: 600; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-muted); background-color: var(--secondary-color); position: sticky; top: 0; z-index: 10; vertical-align: top; }
        tbody tr:hover { background-color: #eef2ff; }
        th:first-child, td:first-child { position: sticky; left: 0; background-color: inherit; }
        th:nth-child(2), td:nth-child(2) { position: sticky; left: 80px; background-color: inherit; }
        table input, table select { width: 90px; padding: 6px 8px; border: 1px solid transparent; border-radius: var(--border-radius-md); background-color: transparent; text-align: center; font-size: 0.95rem; transition: all var(--transition-speed) ease; }
        table input:focus, table select:focus { border-color: var(--primary-color); background-color: var(--white-color); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2); }
        table select { width: 150px; text-align: left; }
        
        thead th .bulk-update-select {
            display: block;
            width: 100%;
            margin-top: 4px;
            font-size: 0.8rem;
            font-weight: 400;
            padding: 2px 4px;
            border-radius: var(--border-radius-md);
            border: 1px solid var(--border-color);
            background-color: var(--white-color);
            color: var(--text-muted);
            cursor: pointer;
        }

        .character-value-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 1.5rem; }
        .character-table-card { background-color: var(--white-color); padding: 1.5rem; border-radius: var(--border-radius-lg); box-shadow: var(--shadow-md); }
        .character-table-card h4 { font-size: 1.1rem; margin-bottom: 1rem; }
        
        /* === MODAL & NOTIFIKASI === */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(17, 24, 39, 0.6); backdrop-filter: blur(4px); align-items: center; justify-content: center; }
        .modal.show { display: flex; animation: contentFadeIn 0.3s forwards; }
        .modal-content { background-color: #fefefe; padding: 0; border: none; width: 95%; max-width: 500px; border-radius: var(--border-radius-lg); box-shadow: var(--shadow-lg); overflow: hidden; animation: slideInUp 0.4s ease-out; }
        @keyframes slideInUp { from { transform: translateY(50px) scale(0.98); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }
        .modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding: 1.25rem 2rem; }
        .modal-header h2 { font-size: 1.25rem; margin-bottom: 0; }
        .close-button { color: var(--text-muted); font-size: 28px; font-weight: bold; cursor: pointer; transition: color 0.2s; }
        .close-button:hover { color: var(--text-color); }
        .modal-body { padding: 2rem; }
        .modal-body .form-group { margin-bottom: 1rem; }
        .modal-body .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
        .modal-body .form-group input, .modal-body .form-group select { width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: var(--border-radius-md); font-size: 1rem; }
        .modal-footer { display: flex; justify-content: flex-end; gap: 1rem; padding: 1.25rem 2rem; border-top: 1px solid var(--border-color); background-color: var(--secondary-color); }

        #notification { position: fixed; bottom: 20px; right: 20px; background-color: var(--success-color); color: white; padding: 1rem 1.5rem; border-radius: var(--border-radius-md); box-shadow: var(--shadow-lg); z-index: 2000; opacity: 0; visibility: hidden; transform: translateY(20px); transition: all 0.4s ease-in-out; }
        #notification.show { opacity: 1; visibility: visible; transform: translateY(0); }
        
        /* === GAYA BARU UNTUK PRESTASI DALAM TABEL === */
        .prestasi-list { list-style: none; padding: 0; margin: 0; }
        .prestasi-item { display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; border-radius: var(--border-radius-md); }
        .prestasi-item:not(:last-child) { border-bottom: 1px dashed var(--border-color); }
        .prestasi-item:hover { background-color: var(--secondary-color); }
        .prestasi-text { flex-grow: 1; white-space: normal; line-height: 1.4; }
        .prestasi-actions { display: flex; gap: 0.5rem; margin-left: 1rem; }
        .action-btn { padding: 0.4rem 0.6rem; font-size: 0.8rem; }
        .btn-warning { background-color: #f59e0b; color: white; }
        .btn-warning:hover { background-color: #d97706; }
        .btn-danger { background-color: #ef4444; color: white; }
        .btn-danger:hover { background-color: #dc2626; }
    </style>
</head>
<body>
    <script src="./Bangbin.js"></script>

    <div id="loginScreen" class="login-screen">
        <div id="loginCard" class="login-card">
            <h1><i class="fa-solid fa-chalkboard-user"></i> Selamat Datang</h1>
            <p>Silakan login untuk mengakses Panel Guru.</p>
            <form id="loginForm">
                <div class="form-group"><label for="username">Username</label><input type="text" id="username" required></div>
                <div class="form-group"><label for="password">Password</label><input type="password" id="password" required></div>
                <button type="submit" class="btn btn-primary">Login</button>
				<a href="./" class="btn btn-primary"><i class="fa-solid fa-home"></i> Beranda</a>
                <p id="errorMessage"></p>
            </form>
        </div>
    </div>

    <div id="appContainer" class="app-container" style="display: none;">
        <nav class="sidebar">
            <div class="sidebar-header">
                <img id="schoolLogo" src="" alt="Logo Sekolah">
                <h2 id="schoolName">Nama Sekolah</h2>
            </div>
            <div class="sidebar-nav">
                <ul>
                    <li><a href="./" class="nav-link active" data-target="home"><i class="fas fa-home icon"></i> <span>Home</span></a></li>
                    <li>
                        <a href="#" class="nav-link has-submenu" data-target="intrakurikuler"><i class="fas fa-book-reader icon"></i> <span>Intrakurikuler</span></a>
                        <ul class="submenu">
                            <li><a href="#nilai-intra-s1" class="nav-link" data-target="nilai-intra-s1">Semester 1</a></li>
                            <li><a href="#nilai-intra-s2" class="nav-link" data-target="nilai-intra-s2">Semester 2</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="nav-link has-submenu" data-target="kokurikuler"><i class="fas fa-award icon"></i> <span>Kokurikuler</span></a>
                         <ul class="submenu">
                            <li><a href="#kokurikuler-s1" class="nav-link" data-target="kokurikuler-s1">Semester 1</a></li>
                            <li><a href="#kokurikuler-s2" class="nav-link" data-target="kokurikuler-s2">Semester 2</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="nav-link has-submenu" data-target="ekstrakurikuler"><i class="fas fa-basketball-ball icon"></i> <span>Ekstrakurikuler</span></a>
                        <ul class="submenu">
                            <li><a href="#ekstrakurikuler-s1" class="nav-link" data-target="ekstrakurikuler-s1">Semester 1</a></li>
                            <li><a href="#ekstrakurikuler-s2" class="nav-link" data-target="ekstrakurikuler-s2">Semester 2</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="nav-link has-submenu" data-target="absensi"><i class="fas fa-clipboard-user icon"></i> <span>Absensi</span></a>
                        <ul class="submenu">
                            <li><a href="#absensi-s1" class="nav-link" data-target="absensi-s1">Semester 1</a></li>
                            <li><a href="#absensi-s2" class="nav-link" data-target="absensi-s2">Semester 2</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="nav-link has-submenu" data-target="prestasi"><i class="fas fa-trophy icon"></i> <span>Prestasi</span></a>
                         <ul class="submenu">
                            <li><a href="#prestasi-s1" class="nav-link" data-target="prestasi-s1">Semester 1</a></li>
                            <li><a href="#prestasi-s2" class="nav-link" data-target="prestasi-s2">Semester 2</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#kenaikan-kelas" class="nav-link" data-target="kenaikan-kelas"><i class="fas fa-graduation-cap icon"></i> <span>Kenaikan Kelas</span></a>
                    </li>
                </ul>
            </div>
            <div class="sidebar-footer">
                 <button id="logoutBtn" class="btn btn-secondary"><i class="fa-solid fa-right-from-bracket"></i> Logout</button>
            </div>
        </nav>

        <div class="main-content-wrapper">
             <header class="header-container">
                <h1 id="pageTitle"><i class="fa-solid fa-home"></i> Home</h1>
                <div class="header-controls">
                    <div class="year-selector">
                        <label for="tahunPelajaranSelector">Tahun Pelajaran:</label>
                        <select id="tahunPelajaranSelector" class="btn btn-outline"></select>
                    </div>
                    <span id="welcomeMessage"></span>
                </div>
            </header>
            <main id="pageContent">
                <section id="home" class="page-section active">
                    <div class="card">
                        <div class="card-header"><h3>Selamat Datang di Panel Guru</h3></div>
                        <p id="welcomeCardInfo">Gunakan menu di samping untuk mengelola data nilai siswa. Anda saat ini mengajar di rombel <b id="infoRombel"></b>.</p>
						<p>Halaman ini adalah halaman guru sesuai dengan kelas yang diampu pada tahun pelajaran tersebut, silahkan hubungi admin apabila terdapat kesalahan atau perbedaan nama siswa.</p>
						<p>Pilih pilihan tahun pelajaran agar sesuai dengan data siswa sesuai kelas yang anda ampu.</p>
						<p>Nilai yang di input automatis akan tersimpan di database</p>
						<p>Nilai Intra input dengan skala Puluhan usahakan untuk memberikan nilai bulat.</p>
						<p>Nilai Ekstrakurikuler adalah predikat, rentang predikat bisa di ubah di menu admin, silahkan berkoordinasi dengan Admin dan Kepala Sekolah.</p>
						<p>Nilai predikat pada Ekstrakurikuler dan Kokurikuler bisa di input secara masal maupun secara individu.</p>						
                    </div>
                </section>
                <section id="nilai-intra-s1" class="page-section">
                    <div class="card">
                        <div class="card-header">
                            <h3>Input Nilai Akademik (Semester 1)</h3>
                            <button class="btn btn-outline" data-action="open-excel-modal" data-semester="semester1"><i class="fa-solid fa-file-excel"></i> Upload Excel</button>
                        </div>
                        <div class="table-wrapper"><table id="siswaTable1"></table></div>
                    </div>
                </section>
                <section id="nilai-intra-s2" class="page-section">
                     <div class="card">
                        <div class="card-header">
                            <h3>Input Nilai Akademik (Semester 2)</h3>
                            <button class="btn btn-outline" data-action="open-excel-modal" data-semester="semester2"><i class="fa-solid fa-file-excel"></i> Upload Excel</button>
                        </div>
                        <div class="table-wrapper"><table id="siswaTable2"></table></div>
                    </div>
                </section>
                <section id="kokurikuler-s1" class="page-section">
                    <div class="card">
                        <div class="card-header"><h3>Input Nilai Karakter (Semester 1)</h3></div>
                        <div class="character-value-container" id="characterTables1"></div>
                    </div>
                </section>
                 <section id="kokurikuler-s2" class="page-section">
                    <div class="card">
                        <div class="card-header"><h3>Input Nilai Karakter (Semester 2)</h3></div>
                        <div class="character-value-container" id="characterTables2"></div>
                    </div>
                </section>
                 <section id="ekstrakurikuler-s1" class="page-section">
                    <div class="card">
                        <div class="card-header"><h3>Input Nilai Ekstrakurikuler (Semester 1)</h3></div>
                        <div id="ekstraTables1"></div>
                    </div>
                </section>
                 <section id="ekstrakurikuler-s2" class="page-section">
                    <div class="card">
                        <div class="card-header"><h3>Input Nilai Ekstrakurikuler (Semester 2)</h3></div>
                        <div id="ekstraTables2"></div>
                    </div>
                </section>
                 <section id="absensi-s1" class="page-section">
                    <div class="card">
                        <div class="card-header"><h3>Input Absensi (Semester 1)</h3></div>
                        <div class="table-wrapper"><table id="absensiTable1"></table></div>
                    </div>
                </section>
                <section id="absensi-s2" class="page-section">
                     <div class="card">
                        <div class="card-header"><h3>Input Absensi (Semester 2)</h3></div>
                        <div class="table-wrapper"><table id="absensiTable2"></table></div>
                    </div>
                </section>
                <section id="prestasi-s1" class="page-section">
                    <div class="card">
                        <div class="card-header"><h3>Input Prestasi Siswa (Semester 1)</h3></div>
                        <div class="table-wrapper"><table id="prestasiTableS1"></table></div>
                    </div>
                </section>
                <section id="prestasi-s2" class="page-section">
                    <div class="card">
                        <div class="card-header"><h3>Input Prestasi Siswa (Semester 2)</h3></div>
                        <div class="table-wrapper"><table id="prestasiTableS2"></table></div>
                    </div>
                </section>
                <section id="kenaikan-kelas" class="page-section">
                    <div class="card">
                        <div class="card-header"><h3>Input Data Kenaikan Kelas</h3></div>
                        <div class="table-wrapper"><table id="kenaikanTable"></table></div>
                    </div>
                </section>
            </main>
        </div>
    </div>
    
    <div id="notification"></div>
    
    <div id="prestasiModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="prestasiModalTitle">Tambah Prestasi</h2>
                <span class="close-button" data-action="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="prestasiForm">
                    <input type="hidden" id="prestasiStudentId"><input type="hidden" id="prestasiSemester"><input type="hidden" id="prestasiIndex">
                    <div class="form-group"><label for="prestasiKegiatan">Kegiatan</label><input type="text" id="prestasiKegiatan" placeholder="Cth: Lomba Cerdas Cermat" required></div>
                    <div class="form-group"><label for="prestasiTingkat">Tingkat</label><select id="prestasiTingkat"><option value="Sekolah">Sekolah</option><option value="Kecamatan">Kecamatan</option><option value="Kota">Kota</option><option value="Provinsi">Provinsi</option><option value="Nasional">Nasional</option><option value="Internasional">Internasional</option><option value="Umum">Umum</option></select></div>
                    <div class="form-group"><label for="prestasiJuara">Juara</label><select id="prestasiJuara"><option value="Juara I">Juara I</option><option value="Juara II">Juara II</option><option value="Juara III">Juara III</option><option value="Harapan I">Harapan I</option><option value="Harapan II">Harapan II</option></select></div>
                    <div class="form-group"><label for="prestasiTahun">Tahun</label><input type="number" id="prestasiTahun" placeholder="Cth: 2024" required></div>
                </form>
            </div>
            <div class="modal-footer"><button class="btn btn-outline" data-action="close-modal">Batal</button><button id="savePrestasiBtn" class="btn btn-primary">Simpan</button></div>
        </div>
    </div>
    
    <div id="excelUploadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Unggah Nilai dari Excel</h2>
                <span class="close-button" data-action="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <p>Ikuti langkah-langkah berikut untuk mengimpor nilai:</p>
                <ol>
                    <li>Unduh format Excel yang telah disediakan.</li>
                    <li>Isi nilai siswa pada kolom mata pelajaran yang sesuai. <strong>Jangan mengubah data NISN dan Nama Siswa.</strong></li>
                    <li>Simpan file, lalu unggah file tersebut di bawah ini.</li>
                </ol>
                <div style="display: flex; justify-content: space-around; align-items: center; margin-top: 2rem; gap: 1rem;">
                    <button id="downloadFormatBtn" class="btn btn-secondary"><i class="fa-solid fa-download"></i> Unduh Format</button>
                    <input type="file" id="excelFileInput" accept=".xlsx, .xls" style="display: none;">
                    <label for="excelFileInput" class="btn btn-primary"><i class="fa-solid fa-upload"></i> Pilih File Excel</label>
                </div>
                 <p id="fileNameLabel" style="text-align: center; margin-top: 1rem; color: var(--text-muted);"></p>
            </div>
             <div class="modal-footer">
                <button class="btn btn-outline" data-action="close-modal">Tutup</button>
            </div>
        </div>
    </div>
    
    <script>
	function _0x3d4e(_0x38932e,_0x549db0){const _0xb15031=_0xb150();return _0x3d4e=function(_0x3d4e48,_0x536ee1){_0x3d4e48=_0x3d4e48-0xda;let _0xd68b96=_0xb15031[_0x3d4e48];return _0xd68b96;},_0x3d4e(_0x38932e,_0x549db0);}const _0x4998f0=_0x3d4e;(function(_0x323ed7,_0xcc9e37){const _0x565c79=_0x3d4e,_0x2e7edd=_0x323ed7();while(!![]){try{const _0x2919c2=parseInt(_0x565c79(0x16c))/0x1*(parseInt(_0x565c79(0x18e))/0x2)+parseInt(_0x565c79(0x160))/0x3+-parseInt(_0x565c79(0xf2))/0x4+parseInt(_0x565c79(0x1b7))/0x5*(-parseInt(_0x565c79(0x187))/0x6)+parseInt(_0x565c79(0x13e))/0x7*(parseInt(_0x565c79(0x119))/0x8)+parseInt(_0x565c79(0x14e))/0x9+parseInt(_0x565c79(0x140))/0xa;if(_0x2919c2===_0xcc9e37)break;else _0x2e7edd['push'](_0x2e7edd['shift']());}catch(_0xf75b96){_0x2e7edd['push'](_0x2e7edd['shift']());}}}(_0xb150,0x27a6b),document[_0x4998f0(0x1c1)](_0x4998f0(0x120),function(){const _0x3c2f5a=_0x4998f0;let _0x2b232b=getDb()||setDefaultData();const _0x690c24=()=>{const _0x258005=_0x3d4e;if(_0x2b232b?.[_0x258005(0x1da)]?.[_0x258005(0x164)]){const _0x2c9e97=document[_0x258005(0x19a)](_0x258005(0x104));_0x2c9e97['rel']='icon',_0x2c9e97[_0x258005(0x1c3)]=_0x258005(0x166),_0x2c9e97[_0x258005(0x1a5)]=_0x2b232b[_0x258005(0x1da)][_0x258005(0x164)],document[_0x258005(0x1be)]['appendChild'](_0x2c9e97);}};_0x690c24();const _0x394340=document[_0x3c2f5a(0x18a)](_0x3c2f5a(0x13f)),_0x558fe3=document['getElementById'](_0x3c2f5a(0x145)),_0xe9e3b8=document[_0x3c2f5a(0x18a)](_0x3c2f5a(0x1c9)),_0x4e2a93=document[_0x3c2f5a(0x18a)]('prestasiModal'),_0x37aab5=document[_0x3c2f5a(0x18a)](_0x3c2f5a(0x10f));let _0x540326='';const _0xf080e9=(_0x1a822e,_0x372a50='success')=>{const _0x465cfa=_0x3c2f5a,_0x2ec7f9=document[_0x465cfa(0x18a)](_0x465cfa(0x172));_0x2ec7f9[_0x465cfa(0x17a)]=_0x1a822e,_0x2ec7f9[_0x465cfa(0xe4)][_0x465cfa(0xdd)]=_0x372a50==='success'?'var(--success-color)':_0x465cfa(0x116),_0x2ec7f9[_0x465cfa(0x12c)]=_0x465cfa(0xf6),setTimeout(()=>_0x2ec7f9[_0x465cfa(0xdc)][_0x465cfa(0x1d0)]('show'),0xbb8);},_0x10e738=({mode:_0x267eec,studentId:_0x2ae4dd,semester:_0x2812c8,index:index=-0x1})=>{const _0x18afa7=_0x3c2f5a,_0x53b847=document[_0x18afa7(0x18a)](_0x18afa7(0xdb));_0x53b847[_0x18afa7(0xe3)](),document[_0x18afa7(0x18a)](_0x18afa7(0x17b))[_0x18afa7(0x18b)]=_0x2ae4dd,document[_0x18afa7(0x18a)](_0x18afa7(0xe0))[_0x18afa7(0x18b)]=_0x2812c8,document[_0x18afa7(0x18a)]('prestasiIndex')[_0x18afa7(0x18b)]=index;if(_0x267eec==='edit'){const _0x147901=_0x2b232b[_0x18afa7(0x117)]['find'](_0x367715=>_0x367715['id']===_0x2ae4dd),_0x38b664=_0x147901['grades'][_0x540326][_0x2812c8][_0x18afa7(0x186)][index];document[_0x18afa7(0x18a)]('prestasiModalTitle')[_0x18afa7(0x17a)]=_0x18afa7(0x194),document[_0x18afa7(0x18a)]('prestasiKegiatan')[_0x18afa7(0x18b)]=_0x38b664['kegiatan'],document[_0x18afa7(0x18a)](_0x18afa7(0x12a))[_0x18afa7(0x18b)]=_0x38b664[_0x18afa7(0xf4)],document[_0x18afa7(0x18a)](_0x18afa7(0x1b5))[_0x18afa7(0x18b)]=_0x38b664[_0x18afa7(0xde)],document[_0x18afa7(0x18a)](_0x18afa7(0x142))[_0x18afa7(0x18b)]=_0x38b664['tahun'];}else document['getElementById'](_0x18afa7(0x168))['textContent']=_0x18afa7(0x180),document['getElementById'](_0x18afa7(0x142))[_0x18afa7(0x18b)]=_0x540326[_0x18afa7(0x123)]('/')[0x0];_0x4e2a93[_0x18afa7(0xdc)][_0x18afa7(0x1aa)](_0x18afa7(0xf6));};document[_0x3c2f5a(0x109)](_0x3c2f5a(0x1b1))[_0x3c2f5a(0x158)](_0x23c99b=>{const _0x8827a6=_0x3c2f5a;_0x23c99b['addEventListener'](_0x8827a6(0x148),()=>{const _0x5584e7=_0x8827a6;_0x23c99b[_0x5584e7(0x13b)](_0x5584e7(0x1b6))['classList'][_0x5584e7(0x1d0)](_0x5584e7(0xf6));});});const _0x797b1f=_0x2d9c5f=>{const _0x1089a7=_0x3c2f5a,_0x2a4e95=document[_0x1089a7(0x1b9)]('.nav-link[data-target=\x22'+_0x2d9c5f+'\x22]');if(_0x2a4e95){const _0x69906e=_0x2a4e95[_0x1089a7(0x1b9)](_0x1089a7(0x16d))[_0x1089a7(0x149)],_0x3a7266=_0x2a4e95['querySelector'](_0x1089a7(0x19d))?_0x2a4e95['querySelector']('span')[_0x1089a7(0x17a)]:_0x2a4e95['textContent'];document['getElementById'](_0x1089a7(0x12d))['innerHTML']=_0x69906e+'\x20'+_0x3a7266;}},_0x4729cd=document[_0x3c2f5a(0x109)](_0x3c2f5a(0xf3));_0x4729cd[_0x3c2f5a(0x158)](_0x180d2e=>{const _0x36c192=_0x3c2f5a;_0x180d2e[_0x36c192(0x1c1)](_0x36c192(0x148),function(_0x308f5f){const _0x4a28be=_0x36c192;if(this[_0x4a28be(0xdc)][_0x4a28be(0x163)](_0x4a28be(0x17c))){_0x308f5f[_0x4a28be(0x17e)](),this[_0x4a28be(0x192)][_0x4a28be(0xdc)][_0x4a28be(0x1bf)](_0x4a28be(0x10a));return;}_0x308f5f['preventDefault']();const _0x5b0a58=this[_0x4a28be(0x18c)][_0x4a28be(0x1cf)];document['querySelectorAll'](_0x4a28be(0x11e))[_0x4a28be(0x158)](_0x21122f=>_0x21122f[_0x4a28be(0xdc)][_0x4a28be(0x1d0)](_0x4a28be(0x121))),document['getElementById'](_0x5b0a58)?.[_0x4a28be(0xdc)][_0x4a28be(0x1aa)](_0x4a28be(0x121)),document[_0x4a28be(0x109)](_0x4a28be(0x16e))[_0x4a28be(0x158)](_0x41acf2=>_0x41acf2[_0x4a28be(0xdc)][_0x4a28be(0x1d0)](_0x4a28be(0x121))),this[_0x4a28be(0xdc)]['add'](_0x4a28be(0x121)),document[_0x4a28be(0x109)](_0x4a28be(0x1bb))['forEach'](_0x51cd39=>{const _0x22bcbe=_0x4a28be;if(!this[_0x22bcbe(0x13b)]('.submenu'))_0x51cd39['classList']['remove'](_0x22bcbe(0x10a));}),_0x797b1f(_0x5b0a58);});});const _0x5cae6a=()=>{const _0x22e08f=_0x3c2f5a,_0x7b5e13=JSON[_0x22e08f(0x1c8)](sessionStorage['getItem'](_0x22e08f(0x1c0))),_0x2ca5b5=_0x2b232b['academicYears'][_0x540326]?.[_0x22e08f(0x101)][_0x22e08f(0x13c)](_0x17cac7=>_0x17cac7[_0x22e08f(0x179)]===_0x7b5e13[_0x22e08f(0x179)]&&_0x17cac7[_0x22e08f(0x183)]===_0x22e08f(0x181));if(!_0x2ca5b5||!_0x2ca5b5['rombelAjar']){document[_0x22e08f(0x109)]('.page-section')[_0x22e08f(0x158)](_0x34fc00=>_0x34fc00[_0x22e08f(0xe4)][_0x22e08f(0x170)]=_0x22e08f(0xfb)),document['getElementById'](_0x22e08f(0x184))[_0x22e08f(0xe4)]['display']=_0x22e08f(0xfa),document[_0x22e08f(0x18a)]('welcomeCardInfo')[_0x22e08f(0x17a)]='Anda\x20tidak\x20ditugaskan\x20sebagai\x20wali\x20kelas\x20di\x20tahun\x20ajaran\x20'+_0x540326+'.';return;}const _0x21936e=_0x2ca5b5[_0x22e08f(0x161)];document[_0x22e08f(0x18a)]('welcomeCardInfo')[_0x22e08f(0x103)]=_0x22e08f(0x14d)+_0x21936e+_0x22e08f(0x1a8)+_0x540326+_0x22e08f(0xf5);const _0x5f0d54=_0x2b232b[_0x22e08f(0x1bc)][_0x540326]?.[_0x22e08f(0x178)]['filter'](_0x59ad64=>_0x59ad64['rombel']===_0x21936e&&_0x59ad64['status']===_0x22e08f(0x182));if(!_0x5f0d54||_0x5f0d54['length']===0x0){const _0x5d39be=_0x22e08f(0x1d4),_0x4fb56a=_0x22e08f(0x14b);[_0x22e08f(0x1a6),_0x22e08f(0x153),_0x22e08f(0x10b),'absensiTable2',_0x22e08f(0x111),'prestasiTableS2','kenaikanTable'][_0x22e08f(0x158)](_0x3d224d=>document['getElementById'](_0x3d224d)[_0x22e08f(0x103)]=_0x5d39be),[_0x22e08f(0x15b),_0x22e08f(0x174),_0x22e08f(0xf1),_0x22e08f(0x173)]['forEach'](_0x2f9bb6=>document[_0x22e08f(0x18a)](_0x2f9bb6)[_0x22e08f(0x103)]=_0x4fb56a);return;}_0x33f8d4(document[_0x22e08f(0x18a)](_0x22e08f(0x1a6)),_0x5f0d54,_0x22e08f(0x1b2)),_0x33f8d4(document['getElementById']('siswaTable2'),_0x5f0d54,_0x22e08f(0x129)),_0x5931b6(document[_0x22e08f(0x18a)](_0x22e08f(0x10b)),_0x5f0d54,'semester1'),_0x5931b6(document[_0x22e08f(0x18a)](_0x22e08f(0xe8)),_0x5f0d54,_0x22e08f(0x129)),_0x1866fe(document['getElementById'](_0x22e08f(0x15b)),_0x5f0d54,_0x22e08f(0x1b2)),_0x1866fe(document[_0x22e08f(0x18a)]('ekstraTables2'),_0x5f0d54,'semester2'),_0x2692d6(document[_0x22e08f(0x18a)](_0x22e08f(0xf1)),_0x5f0d54,_0x22e08f(0x1b2)),_0x2692d6(document[_0x22e08f(0x18a)](_0x22e08f(0x173)),_0x5f0d54,_0x22e08f(0x129)),_0x2b23f3(document[_0x22e08f(0x18a)]('prestasiTableS1'),_0x5f0d54,'semester1'),_0x2b23f3(document[_0x22e08f(0x18a)](_0x22e08f(0x16a)),_0x5f0d54,_0x22e08f(0x129)),_0x1cbdda(document[_0x22e08f(0x18a)](_0x22e08f(0x15f)),_0x5f0d54);},_0x33f8d4=(_0x49fb9b,_0x2d09be,_0x45cfce)=>{const _0x5ce3e9=_0x3c2f5a,_0x3dbbda=_0x2b232b[_0x5ce3e9(0x1bc)][_0x540326]?.['subjects']||[];let _0x353cc7=_0x5ce3e9(0x14c);_0x3dbbda['forEach'](_0x5eebb9=>_0x353cc7+=_0x5ce3e9(0xeb)+_0x5eebb9[_0x5ce3e9(0x146)]+_0x5ce3e9(0x1ad)),_0x353cc7+=_0x5ce3e9(0x11b);let _0x3a2ff2=_0x5ce3e9(0xf8);_0x2d09be[_0x5ce3e9(0x158)](_0x2f74e2=>{const _0x5e4efa=_0x5ce3e9,_0x1c6cd0=_0x2b232b['masterSiswa'][_0x5e4efa(0x13c)](_0x43db75=>_0x43db75['id']===_0x2f74e2[_0x5e4efa(0x113)]);if(!_0x1c6cd0)return;const _0x548441=_0x1c6cd0[_0x5e4efa(0x188)]?.[_0x540326]?.[_0x45cfce]||{};let _0xce71e1=_0x5e4efa(0x1d5)+_0x1c6cd0[_0x5e4efa(0x10c)]+_0x5e4efa(0x125)+_0x1c6cd0[_0x5e4efa(0x1ba)]+_0x5e4efa(0x114);_0x3dbbda[_0x5e4efa(0x158)](_0x1fe0a1=>_0xce71e1+=_0x5e4efa(0x127)+(_0x548441[_0x5e4efa(0xe7)]?.[_0x1fe0a1[_0x5e4efa(0x146)]]||'')+_0x5e4efa(0x156)+_0x1c6cd0['id']+_0x5e4efa(0x15c)+_0x1fe0a1['shortName']+_0x5e4efa(0x1d9)+_0x45cfce+_0x5e4efa(0x1bd)),_0xce71e1+=_0x5e4efa(0x1a2),_0x3a2ff2+=_0xce71e1;}),_0x49fb9b[_0x5ce3e9(0x103)]=_0x353cc7+_0x5ce3e9(0x1ae)+_0x3a2ff2;},_0x5931b6=(_0x858e59,_0x38dd35,_0x34fd2d)=>{const _0x4dde6d=_0x3c2f5a;let _0x1d6bc9=_0x4dde6d(0x106),_0x489956=_0x4dde6d(0xf8);_0x38dd35[_0x4dde6d(0x158)](_0x1b8008=>{const _0x8987bb=_0x4dde6d,_0xd03e3c=_0x2b232b[_0x8987bb(0x117)][_0x8987bb(0x13c)](_0xe5c178=>_0xe5c178['id']===_0x1b8008['studentId']);if(!_0xd03e3c)return;const _0x3c33a8=_0xd03e3c[_0x8987bb(0x188)]?.[_0x540326]?.[_0x34fd2d]||{},_0x502292=_0x3c33a8[_0x8987bb(0xe9)]||{};let _0x145c88=_0x8987bb(0x1d5)+_0xd03e3c['s_nisn']+_0x8987bb(0x125)+_0xd03e3c['s_nama']+_0x8987bb(0x114);_0x145c88+=_0x8987bb(0xdf)+(_0x502292['sakit']||0x0)+_0x8987bb(0x156)+_0xd03e3c['id']+_0x8987bb(0x139)+_0x34fd2d+_0x8987bb(0x1bd),_0x145c88+='<td><input\x20type=\x22number\x22\x20min=\x220\x22\x20value=\x22'+(_0x502292[_0x8987bb(0x1d1)]||0x0)+_0x8987bb(0x156)+_0xd03e3c['id']+_0x8987bb(0x1a4)+_0x34fd2d+'\x22></td>',_0x145c88+='<td><input\x20type=\x22number\x22\x20min=\x220\x22\x20value=\x22'+(_0x502292[_0x8987bb(0x124)]||0x0)+_0x8987bb(0x156)+_0xd03e3c['id']+'\x22\x20data-type=\x22absence\x22\x20data-name=\x22alpha\x22\x20data-semester=\x22'+_0x34fd2d+_0x8987bb(0x1bd),_0x145c88+='</tr>',_0x489956+=_0x145c88;}),_0x858e59[_0x4dde6d(0x103)]=_0x1d6bc9+_0x4dde6d(0x1ae)+_0x489956;},_0x1866fe=(_0x1dc31d,_0x5bf7d0,_0x3a491a)=>{const _0x385d52=_0x3c2f5a,_0x35d520=_0x2b232b[_0x385d52(0x1bc)][_0x540326]?.[_0x385d52(0x147)]||[];_0x1dc31d[_0x385d52(0x103)]='';if(_0x35d520[_0x385d52(0x165)]===0x0){_0x1dc31d['innerHTML']='<p>Tidak\x20ada\x20data\x20ekstrakurikuler\x20untuk\x20diinput.</p>';return;}const _0x2558d2=_0x2b232b[_0x385d52(0x1bc)][_0x540326]?.['characterGradeOptions']||[],_0x5896a3=_0x2558d2[_0x385d52(0x1a3)](_0x409aa6=>'<option\x20value=\x22'+_0x409aa6+'\x22>'+_0x409aa6+'</option>')[_0x385d52(0x185)]('');let _0x40f778='<div\x20class=\x22table-wrapper\x22><table><thead><tr><th>NISN</th><th>Nama\x20Siswa</th>';_0x35d520[_0x385d52(0x158)](_0x2431e6=>{const _0xc3638=_0x385d52;_0x40f778+=_0xc3638(0xeb)+_0x2431e6['name']+_0xc3638(0x13a)+_0x2431e6['name']+_0xc3638(0x1d9)+_0x3a491a+_0xc3638(0xe5)+_0x5896a3+_0xc3638(0xfc);}),_0x40f778+='</tr></thead><tbody>',_0x5bf7d0[_0x385d52(0x158)](_0x4ed597=>{const _0x5bfc8d=_0x385d52,_0x2c38d6=_0x2b232b[_0x5bfc8d(0x117)][_0x5bfc8d(0x13c)](_0x142183=>_0x142183['id']===_0x4ed597[_0x5bfc8d(0x113)]);if(!_0x2c38d6)return;const _0x476412=_0x2c38d6[_0x5bfc8d(0x188)]?.[_0x540326]?.[_0x3a491a]||{};_0x40f778+='<tr><td>'+_0x2c38d6[_0x5bfc8d(0x10c)]+_0x5bfc8d(0x125)+_0x2c38d6['s_nama']+_0x5bfc8d(0x114),_0x35d520[_0x5bfc8d(0x158)](_0x55d744=>{const _0x137922=_0x5bfc8d,_0x40e50b=_0x476412[_0x137922(0x147)]?.[_0x55d744['name']]||'',_0x5ed76c=_0x2558d2[_0x137922(0x1a3)](_0x432bea=>_0x137922(0x126)+_0x432bea+'\x22\x20'+(_0x432bea===_0x40e50b?_0x137922(0x198):'')+'>'+_0x432bea+'</option>')[_0x137922(0x185)]('');_0x40f778+=_0x137922(0x1d6)+_0x2c38d6['id']+_0x137922(0x1af)+_0x55d744[_0x137922(0x199)]+_0x137922(0x1d9)+_0x3a491a+_0x137922(0x15a)+_0x5ed76c+_0x137922(0x1b4);}),_0x40f778+=_0x5bfc8d(0x1a2);}),_0x40f778+=_0x385d52(0x11c),_0x1dc31d[_0x385d52(0x103)]=_0x40f778;},_0x2692d6=(_0x5b74a8,_0x40c42f,_0x2bc2f3)=>{const _0x47ae14=_0x3c2f5a,_0x4b5c8d=_0x2b232b[_0x47ae14(0x1bc)][_0x540326]?.[_0x47ae14(0x196)]||[],_0x57a9f3=_0x2b232b[_0x47ae14(0x1bc)][_0x540326]?.[_0x47ae14(0x130)]||[];_0x5b74a8[_0x47ae14(0x103)]='';if(_0x4b5c8d['length']===0x0){_0x5b74a8['innerHTML']=_0x47ae14(0x197);return;}_0x4b5c8d['forEach'](_0x2d0857=>{const _0x41dd88=_0x47ae14;let _0x3b6d4e=_0x41dd88(0xe6)+_0x2d0857['name']+_0x41dd88(0x15e);_0x2d0857[_0x41dd88(0x175)][_0x41dd88(0x158)](_0x44853b=>{const _0x157157=_0x41dd88,_0xa272d0=_0x57a9f3[_0x157157(0x1a3)](_0x595a36=>_0x157157(0x126)+_0x595a36+'\x22>'+_0x595a36+'</option>')['join']('');_0x3b6d4e+=_0x157157(0xeb)+_0x44853b[_0x157157(0x199)]+_0x157157(0xed)+_0x2d0857[_0x157157(0x199)]+_0x157157(0x14f)+_0x44853b[_0x157157(0x199)]+_0x157157(0x1d9)+_0x2bc2f3+_0x157157(0xe5)+_0xa272d0+_0x157157(0xfc);}),_0x3b6d4e+=_0x41dd88(0x1d3),_0x40c42f[_0x41dd88(0x158)](_0x52d08a=>{const _0x59ea17=_0x41dd88,_0x55d0f7=_0x2b232b['masterSiswa'][_0x59ea17(0x13c)](_0x5c8ec6=>_0x5c8ec6['id']===_0x52d08a[_0x59ea17(0x113)]);if(!_0x55d0f7)return;const _0x3b1612=_0x55d0f7[_0x59ea17(0x188)]?.[_0x540326]?.[_0x2bc2f3]?.[_0x59ea17(0x1c7)]?.[_0x2d0857[_0x59ea17(0x199)]]||{};_0x3b6d4e+=_0x59ea17(0x1d5)+_0x55d0f7[_0x59ea17(0x10c)]+_0x59ea17(0x125)+_0x55d0f7[_0x59ea17(0x1ba)]+_0x59ea17(0x114),_0x2d0857[_0x59ea17(0x175)][_0x59ea17(0x158)](_0x1b170c=>{const _0xb4b7b=_0x59ea17,_0x30e88d=_0x3b1612[_0x1b170c['name']]||'',_0x40911a=_0x57a9f3['map'](_0xa0e0e1=>_0xb4b7b(0x126)+_0xa0e0e1+'\x22\x20'+(_0xa0e0e1===_0x30e88d?_0xb4b7b(0x198):'')+'>'+_0xa0e0e1+'</option>')[_0xb4b7b(0x185)]('');_0x3b6d4e+='<td><select\x20data-student-id=\x22'+_0x55d0f7['id']+_0xb4b7b(0x167)+_0x2d0857[_0xb4b7b(0x199)]+'\x22\x20data-sub-name=\x22'+_0x1b170c[_0xb4b7b(0x199)]+_0xb4b7b(0x1d9)+_0x2bc2f3+'\x22><option\x20value=\x22\x22>--Pilih--</option>'+_0x40911a+_0xb4b7b(0x1b4);}),_0x3b6d4e+=_0x59ea17(0x1a2);}),_0x3b6d4e+=_0x41dd88(0x112),_0x5b74a8[_0x41dd88(0x103)]+=_0x3b6d4e;});},_0x2b23f3=(_0x317cab,_0x140c9a,_0x3cb4b1)=>{const _0x123e65=_0x3c2f5a;let _0x220011=_0x123e65(0xef),_0x2344b9='<tbody>';_0x140c9a[_0x123e65(0x158)](_0x10bd86=>{const _0x3303d3=_0x123e65,_0x33bfd4=_0x2b232b[_0x3303d3(0x117)][_0x3303d3(0x13c)](_0x4469dc=>_0x4469dc['id']===_0x10bd86[_0x3303d3(0x113)]);if(!_0x33bfd4)return;const _0x52d846=_0x33bfd4[_0x3303d3(0x188)]?.[_0x540326]?.[_0x3cb4b1]?.[_0x3303d3(0x186)]||[];let _0x531bd8=_0x3303d3(0x133);_0x52d846[_0x3303d3(0x165)]>0x0?_0x52d846['forEach']((_0x1e07ed,_0x53d967)=>{const _0x49f535=_0x3303d3;_0x531bd8+=_0x49f535(0x16f)+(_0x1e07ed[_0x49f535(0xde)]||'')+_0x49f535(0x1a1)+(_0x1e07ed[_0x49f535(0x11d)]||'')+'\x20('+(_0x1e07ed[_0x49f535(0xf4)]||'')+',\x20'+(_0x1e07ed[_0x49f535(0xf9)]||'')+_0x49f535(0xda)+_0x33bfd4['id']+'\x22\x20data-semester=\x22'+_0x3cb4b1+_0x49f535(0x162)+_0x53d967+'\x22><i\x20class=\x22fa-solid\x20fa-pencil\x22></i></button><button\x20class=\x22btn\x20btn-danger\x20action-btn\x22\x20data-action=\x22delete-prestasi\x22\x20data-student-id=\x22'+_0x33bfd4['id']+_0x49f535(0x1d9)+_0x3cb4b1+_0x49f535(0x162)+_0x53d967+_0x49f535(0x115);}):_0x531bd8+=_0x3303d3(0x19b),_0x531bd8+=_0x3303d3(0x1cc),_0x2344b9+=_0x3303d3(0x1d5)+_0x33bfd4['s_nisn']+_0x3303d3(0x125)+_0x33bfd4[_0x3303d3(0x1ba)]+_0x3303d3(0xe2)+_0x531bd8+_0x3303d3(0xfd)+_0x33bfd4['id']+_0x3303d3(0x1d9)+_0x3cb4b1+_0x3303d3(0x118);}),_0x317cab['innerHTML']=_0x220011+_0x123e65(0x1ae)+_0x2344b9;},_0x1cbdda=(_0x51bf36,_0x16b560)=>{const _0x5009a2=_0x3c2f5a;let _0x2961f6=_0x5009a2(0x151),_0x3b7824=_0x5009a2(0xf8);_0x16b560[_0x5009a2(0x158)](_0x47e94c=>{const _0x25c9ae=_0x5009a2,_0x297e40=_0x2b232b[_0x25c9ae(0x117)][_0x25c9ae(0x13c)](_0x194198=>_0x194198['id']===_0x47e94c[_0x25c9ae(0x113)]);if(!_0x297e40)return;if(!_0x297e40[_0x25c9ae(0x188)]?.[_0x540326]){if(!_0x297e40[_0x25c9ae(0x188)])_0x297e40[_0x25c9ae(0x188)]={};_0x297e40['grades'][_0x540326]={'promotion':{'status':null,'note':''}};}else!_0x297e40[_0x25c9ae(0x188)][_0x540326][_0x25c9ae(0x10d)]&&(_0x297e40[_0x25c9ae(0x188)][_0x540326][_0x25c9ae(0x10d)]={'status':null,'note':''});const {status:status='',note:note=''}=_0x297e40[_0x25c9ae(0x188)][_0x540326]['promotion'];_0x3b7824+=_0x25c9ae(0x1d5)+_0x297e40[_0x25c9ae(0x10c)]+_0x25c9ae(0x125)+_0x297e40['s_nama']+'</td><td><select\x20data-student-id=\x22'+_0x297e40['id']+_0x25c9ae(0x122)+(status===''?_0x25c9ae(0x198):'')+'>--\x20Pilih\x20Status\x20--</option><option\x20value=\x22Naik\x20Kelas\x22\x20'+(status===_0x25c9ae(0x1c2)?_0x25c9ae(0x198):'')+'>Naik\x20Kelas</option><option\x20value=\x22Tidak\x20Naik\x20Kelas\x22\x20'+(status===_0x25c9ae(0x12b)?_0x25c9ae(0x198):'')+_0x25c9ae(0x19c)+note+_0x25c9ae(0x1c4)+_0x297e40['id']+_0x25c9ae(0x144);}),_0x51bf36[_0x5009a2(0x103)]=_0x2961f6+_0x5009a2(0x1ae)+_0x3b7824;};let _0x4d0a1c;_0x558fe3['addEventListener'](_0x3c2f5a(0xee),_0x275626=>{const _0xe278c6=_0x3c2f5a;if(_0x275626[_0xe278c6(0x1cf)][_0xe278c6(0x195)](_0xe278c6(0x17f))){const _0x525d3d=_0x275626[_0xe278c6(0x1cf)],_0x34347c=_0x525d3d[_0xe278c6(0x18b)];if(_0x34347c==='')return;const {type:_0x5477c4,semester:_0xfa0c41,name:_0x774e66,characterName:_0x462974,subName:_0x5a465f}=_0x525d3d[_0xe278c6(0x18c)],_0x4cb359=_0x525d3d['closest']('table'),_0x27c3d8=_0x525d3d[_0xe278c6(0x13b)]('th'),_0x131f79=Array[_0xe278c6(0xf7)](_0x27c3d8[_0xe278c6(0x152)][_0xe278c6(0x1ce)])[_0xe278c6(0x1b8)](_0x27c3d8),_0x29bf37=_0x4cb359[_0xe278c6(0x109)]('tbody\x20tr');_0x29bf37['forEach'](_0x413950=>{const _0x2d2831=_0xe278c6,_0x304921=_0x413950['children'][_0x131f79]?.[_0x2d2831(0x1b9)](_0x2d2831(0x105));if(_0x304921){_0x304921['value']=_0x34347c;const _0x2579d4=_0x2b232b['masterSiswa'][_0x2d2831(0x13c)](_0x5a2a0b=>_0x5a2a0b['id']===Number(_0x304921[_0x2d2831(0x18c)][_0x2d2831(0x113)]));if(!_0x2579d4)return;if(!_0x2579d4[_0x2d2831(0x188)])_0x2579d4[_0x2d2831(0x188)]={};if(!_0x2579d4['grades'][_0x540326])_0x2579d4[_0x2d2831(0x188)][_0x540326]={};if(!_0x2579d4[_0x2d2831(0x188)][_0x540326][_0xfa0c41])_0x2579d4['grades'][_0x540326][_0xfa0c41]={};const _0x2c3eed=_0x2579d4[_0x2d2831(0x188)][_0x540326][_0xfa0c41];if(_0x5477c4===_0x2d2831(0x1a9)){if(!_0x2c3eed[_0x2d2831(0x147)])_0x2c3eed['extracurriculars']={};_0x2c3eed['extracurriculars'][_0x774e66]=_0x34347c;}else{if(_0x5477c4===_0x2d2831(0x1c7)){if(!_0x2c3eed[_0x2d2831(0x1c7)])_0x2c3eed[_0x2d2831(0x1c7)]={};if(!_0x2c3eed['character'][_0x462974])_0x2c3eed['character'][_0x462974]={};_0x2c3eed['character'][_0x462974][_0x5a465f]=_0x34347c;}}}}),saveDb(_0x2b232b),_0xf080e9(_0xe278c6(0x1ab)),_0x525d3d[_0xe278c6(0x18b)]='';}else _0x275626[_0xe278c6(0x1cf)][_0xe278c6(0x195)](_0xe278c6(0x105))&&(clearTimeout(_0x4d0a1c),_0x4d0a1c=setTimeout(()=>{const _0x3b78fa=_0xe278c6,{studentId:_0x2d42aa,semester:_0x1b7974,type:_0x312062,name:_0x3b083a}=_0x275626[_0x3b78fa(0x1cf)][_0x3b78fa(0x18c)],_0x2c683b=_0x2b232b['masterSiswa'][_0x3b78fa(0x13c)](_0x57f0c2=>_0x57f0c2['id']===Number(_0x2d42aa));if(!_0x2c683b)return;const _0x2320c5=_0x312062===_0x3b78fa(0x1a7)||_0x312062==='absence'?Number(_0x275626[_0x3b78fa(0x1cf)][_0x3b78fa(0x18b)]):_0x275626['target'][_0x3b78fa(0x18b)];if(_0x312062===_0x3b78fa(0x10d)){if(!_0x2c683b['grades'])_0x2c683b[_0x3b78fa(0x188)]={};if(!_0x2c683b[_0x3b78fa(0x188)][_0x540326])_0x2c683b[_0x3b78fa(0x188)][_0x540326]={'promotion':{}};if(!_0x2c683b['grades'][_0x540326][_0x3b78fa(0x10d)])_0x2c683b['grades'][_0x540326][_0x3b78fa(0x10d)]={};_0x2c683b[_0x3b78fa(0x188)][_0x540326]['promotion'][_0x3b083a]=_0x2320c5;}else{if(!_0x2c683b[_0x3b78fa(0x188)])_0x2c683b[_0x3b78fa(0x188)]={};if(!_0x2c683b[_0x3b78fa(0x188)][_0x540326])_0x2c683b['grades'][_0x540326]={};if(!_0x2c683b[_0x3b78fa(0x188)][_0x540326][_0x1b7974])_0x2c683b[_0x3b78fa(0x188)][_0x540326][_0x1b7974]={};const _0x45112a=_0x2c683b['grades'][_0x540326][_0x1b7974];if(_0x312062==='subject'){if(!_0x45112a[_0x3b78fa(0xe7)])_0x45112a[_0x3b78fa(0xe7)]={};_0x45112a[_0x3b78fa(0xe7)][_0x3b083a]=_0x2320c5;}else{if(_0x312062===_0x3b78fa(0x1a9)){if(!_0x45112a['extracurriculars'])_0x45112a[_0x3b78fa(0x147)]={};_0x45112a[_0x3b78fa(0x147)][_0x3b083a]=_0x2320c5;}else{if(_0x312062==='absence'){if(!_0x45112a[_0x3b78fa(0xe9)])_0x45112a[_0x3b78fa(0xe9)]={};_0x45112a[_0x3b78fa(0xe9)][_0x3b083a]=_0x2320c5;}else{if(_0x312062==='character'){const {characterName:_0x46bba5,subName:_0x1d1951}=_0x275626['target'][_0x3b78fa(0x18c)];if(!_0x45112a['character'])_0x45112a[_0x3b78fa(0x1c7)]={};if(!_0x45112a[_0x3b78fa(0x1c7)][_0x46bba5])_0x45112a[_0x3b78fa(0x1c7)][_0x46bba5]={};_0x45112a[_0x3b78fa(0x1c7)][_0x46bba5][_0x1d1951]=_0x2320c5;}}}}}saveDb(_0x2b232b),_0xf080e9(_0x3b78fa(0x18d));},0x1f4));}),_0x558fe3[_0x3c2f5a(0x1c1)](_0x3c2f5a(0x148),_0x281715=>{const _0x523a28=_0x3c2f5a,_0x55cfd7=_0x281715['target'][_0x523a28(0x13b)](_0x523a28(0x110));if(!_0x55cfd7)return;const {action:_0x10160c,studentId:_0x1a078c,semester:_0x514635,index:_0x49c35a}=_0x55cfd7[_0x523a28(0x18c)];if(_0x10160c===_0x523a28(0x1d2)){_0x37aab5[_0x523a28(0x18c)]['semester']=_0x514635,document[_0x523a28(0x18a)](_0x523a28(0x190))[_0x523a28(0x17a)]='',_0x37aab5[_0x523a28(0xdc)][_0x523a28(0x1aa)](_0x523a28(0xf6));return;}const _0x53f67b=_0x2b232b[_0x523a28(0x117)]['find'](_0x3f7ca0=>_0x3f7ca0['id']===Number(_0x1a078c));if(!_0x53f67b)return;if(_0x10160c==='add-prestasi')_0x10e738({'mode':_0x523a28(0x1aa),'studentId':Number(_0x1a078c),'semester':_0x514635});else{if(_0x10160c===_0x523a28(0x14a))_0x10e738({'mode':_0x523a28(0x193),'studentId':Number(_0x1a078c),'semester':_0x514635,'index':Number(_0x49c35a)});else _0x10160c==='delete-prestasi'&&(confirm(_0x523a28(0x12f))&&(_0x53f67b[_0x523a28(0x188)][_0x540326][_0x514635][_0x523a28(0x186)]['splice'](Number(_0x49c35a),0x1),saveDb(_0x2b232b),_0xf080e9(_0x523a28(0x1b3)),_0x5cae6a()));}}),document[_0x3c2f5a(0x18a)](_0x3c2f5a(0xfe))[_0x3c2f5a(0x1c1)](_0x3c2f5a(0x148),()=>{const _0x8e8b16=_0x3c2f5a,_0x1321dc=Number(document[_0x8e8b16(0x18a)](_0x8e8b16(0x17b))[_0x8e8b16(0x18b)]),_0x49ac76=document[_0x8e8b16(0x18a)](_0x8e8b16(0xe0))[_0x8e8b16(0x18b)],_0x1c9f28=Number(document[_0x8e8b16(0x18a)](_0x8e8b16(0xec))[_0x8e8b16(0x18b)]),_0x1ac8e7=_0x2b232b[_0x8e8b16(0x117)][_0x8e8b16(0x13c)](_0x1226a9=>_0x1226a9['id']===_0x1321dc),_0x46dc5d={'kegiatan':document[_0x8e8b16(0x18a)](_0x8e8b16(0x128))[_0x8e8b16(0x18b)],'tingkat':document[_0x8e8b16(0x18a)](_0x8e8b16(0x12a))['value'],'juara':document[_0x8e8b16(0x18a)]('prestasiJuara')[_0x8e8b16(0x18b)],'tahun':document[_0x8e8b16(0x18a)](_0x8e8b16(0x142))['value']};if(!_0x46dc5d[_0x8e8b16(0x11d)]||!_0x46dc5d['tahun']){_0xf080e9(_0x8e8b16(0x143),_0x8e8b16(0x176));return;}if(!_0x1ac8e7[_0x8e8b16(0x188)]?.[_0x540326]?.[_0x49ac76]){if(!_0x1ac8e7[_0x8e8b16(0x188)])_0x1ac8e7[_0x8e8b16(0x188)]={};if(!_0x1ac8e7['grades'][_0x540326])_0x1ac8e7[_0x8e8b16(0x188)][_0x540326]={};_0x1ac8e7[_0x8e8b16(0x188)][_0x540326][_0x49ac76]={'prestasi':[]};}if(!_0x1ac8e7[_0x8e8b16(0x188)][_0x540326][_0x49ac76]['prestasi'])_0x1ac8e7[_0x8e8b16(0x188)][_0x540326][_0x49ac76][_0x8e8b16(0x186)]=[];_0x1c9f28>-0x1?_0x1ac8e7[_0x8e8b16(0x188)][_0x540326][_0x49ac76][_0x8e8b16(0x186)][_0x1c9f28]=_0x46dc5d:_0x1ac8e7['grades'][_0x540326][_0x49ac76][_0x8e8b16(0x186)][_0x8e8b16(0x1c6)](_0x46dc5d),saveDb(_0x2b232b),_0xf080e9(_0x8e8b16(0x10e)),_0x4e2a93[_0x8e8b16(0xdc)][_0x8e8b16(0x1d0)]('show'),_0x5cae6a();}),document['getElementById'](_0x3c2f5a(0x171))[_0x3c2f5a(0x1c1)](_0x3c2f5a(0x148),()=>{const _0x17a8d6=_0x3c2f5a,_0x350f7f=_0x37aab5['dataset']['semester'],_0x4afbf4=JSON[_0x17a8d6(0x1c8)](sessionStorage[_0x17a8d6(0x102)](_0x17a8d6(0x1c0))),_0x2592a2=_0x2b232b['academicYears'][_0x540326][_0x17a8d6(0x101)]['find'](_0x2695c3=>_0x2695c3[_0x17a8d6(0x179)]===_0x4afbf4['username'])[_0x17a8d6(0x161)],_0x8f249c=_0x2b232b[_0x17a8d6(0x1bc)][_0x540326][_0x17a8d6(0x178)][_0x17a8d6(0x15d)](_0x218655=>_0x218655['rombel']===_0x2592a2&&_0x218655[_0x17a8d6(0xf0)]===_0x17a8d6(0x182)),_0x5528c4=_0x2b232b[_0x17a8d6(0x1bc)][_0x540326][_0x17a8d6(0xe7)]||[];let _0x46dc31=[];_0x8f249c[_0x17a8d6(0x158)](_0x8d534d=>{const _0x390158=_0x17a8d6,_0x1ec7f0=_0x2b232b[_0x390158(0x117)]['find'](_0x39db2a=>_0x39db2a['id']===_0x8d534d[_0x390158(0x113)]);if(_0x1ec7f0){let _0x5319a8={'NISN':_0x1ec7f0['s_nisn'],'Nama\x20Siswa':_0x1ec7f0[_0x390158(0x1ba)]};_0x5528c4[_0x390158(0x158)](_0x5e7a60=>_0x5319a8[_0x5e7a60['shortName']]=''),_0x46dc31[_0x390158(0x1c6)](_0x5319a8);}});const _0xee6b26=XLSX[_0x17a8d6(0xea)][_0x17a8d6(0x1d8)](_0x46dc31),_0x483612=XLSX[_0x17a8d6(0xea)][_0x17a8d6(0x100)]();XLSX[_0x17a8d6(0xea)][_0x17a8d6(0x155)](_0x483612,_0xee6b26,_0x17a8d6(0x11f)),XLSX['writeFile'](_0x483612,_0x17a8d6(0x1d7)+(_0x350f7f===_0x17a8d6(0x1b2)?'S1':'S2')+'-'+_0x540326[_0x17a8d6(0x157)]('/','-')+'.xlsx');}),document[_0x3c2f5a(0x18a)]('excelFileInput')[_0x3c2f5a(0x1c1)](_0x3c2f5a(0xee),_0x13f48a=>{const _0x62eba=_0x3c2f5a,_0x52bc3c=_0x13f48a[_0x62eba(0x1cf)]['files'][0x0];if(!_0x52bc3c)return;document[_0x62eba(0x18a)](_0x62eba(0x190))[_0x62eba(0x17a)]=_0x62eba(0x18f)+_0x52bc3c['name'];const _0x2e19e0=new FileReader();_0x2e19e0[_0x62eba(0x177)]=function(_0x5017a2){const _0x26be94=_0x62eba;try{const _0x5e7819=new Uint8Array(_0x5017a2[_0x26be94(0x1cf)][_0x26be94(0x107)]),_0x3d5207=XLSX[_0x26be94(0x1a0)](_0x5e7819,{'type':_0x26be94(0x1b0)}),_0x48263a=_0x3d5207[_0x26be94(0x1cd)][0x0],_0xf89df9=_0x3d5207[_0x26be94(0x136)][_0x48263a],_0x4e40e1=XLSX[_0x26be94(0xea)][_0x26be94(0x189)](_0xf89df9),_0xcdef22=_0x37aab5[_0x26be94(0x18c)]['semester'],_0x22fc24=_0x2b232b['academicYears'][_0x540326][_0x26be94(0xe7)][_0x26be94(0x1a3)](_0x589d25=>_0x589d25['shortName']);let _0x29b458=0x0;_0x4e40e1['forEach'](_0x56f2d8=>{const _0x594a54=_0x26be94;if(!_0x56f2d8[_0x594a54(0x19e)])return;const _0x3f784d=_0x2b232b['masterSiswa'][_0x594a54(0x13c)](_0x1a85e0=>_0x1a85e0[_0x594a54(0x10c)]==_0x56f2d8[_0x594a54(0x19e)]);if(_0x3f784d){if(!_0x3f784d['grades'])_0x3f784d[_0x594a54(0x188)]={};if(!_0x3f784d[_0x594a54(0x188)][_0x540326])_0x3f784d[_0x594a54(0x188)][_0x540326]={};if(!_0x3f784d['grades'][_0x540326][_0xcdef22])_0x3f784d[_0x594a54(0x188)][_0x540326][_0xcdef22]={};if(!_0x3f784d['grades'][_0x540326][_0xcdef22][_0x594a54(0xe7)])_0x3f784d['grades'][_0x540326][_0xcdef22][_0x594a54(0xe7)]={};_0x22fc24['forEach'](_0x3db3e9=>{const _0x80a1f4=_0x594a54;_0x56f2d8[_0x3db3e9]!==undefined&&!isNaN(parseInt(_0x56f2d8[_0x3db3e9]))&&(_0x3f784d[_0x80a1f4(0x188)][_0x540326][_0xcdef22][_0x80a1f4(0xe7)][_0x3db3e9]=parseInt(_0x56f2d8[_0x3db3e9]));}),_0x29b458++;}}),_0x29b458>0x0?(saveDb(_0x2b232b),_0xf080e9(_0x29b458+_0x26be94(0x1ac)),_0x5cae6a(),_0x37aab5['classList'][_0x26be94(0x1d0)](_0x26be94(0xf6))):_0xf080e9('Tidak\x20ada\x20data\x20yang\x20cocok\x20untuk\x20diimpor.\x20Pastikan\x20NISN\x20di\x20Excel\x20benar.',_0x26be94(0x176));}catch(_0x52514d){_0xf080e9(_0x26be94(0x13d),_0x26be94(0x176)),console[_0x26be94(0x176)]('Error\x20processing\x20excel\x20file:\x20',_0x52514d);}finally{_0x13f48a[_0x26be94(0x1cf)][_0x26be94(0x18b)]='';}},_0x2e19e0[_0x62eba(0x135)](_0x52bc3c);}),document[_0x3c2f5a(0x18a)](_0x3c2f5a(0x191))['addEventListener'](_0x3c2f5a(0x148),()=>{const _0xa696c7=_0x3c2f5a;sessionStorage[_0xa696c7(0x1ca)](_0xa696c7(0x1c0)),window[_0xa696c7(0x154)][_0xa696c7(0xe1)]();}),document[_0x3c2f5a(0x18a)]('tahunPelajaranSelector')[_0x3c2f5a(0x1c1)](_0x3c2f5a(0xee),_0x23ca67=>{const _0x5ef478=_0x3c2f5a;_0x540326=_0x23ca67['target'][_0x5ef478(0x18b)],_0x5cae6a();});const _0x1edb42=()=>{const _0x28da49=_0x3c2f5a,_0x29dc0c=JSON['parse'](sessionStorage['getItem'](_0x28da49(0x1c0)));if(_0x29dc0c&&_0x29dc0c[_0x28da49(0x183)]==='Guru'){_0x394340['style'][_0x28da49(0x170)]='none',_0x558fe3['style']['display']=_0x28da49(0x17d),document[_0x28da49(0x18a)](_0x28da49(0x16b))[_0x28da49(0x17a)]=_0x28da49(0x131)+_0x29dc0c[_0x28da49(0x11a)]+'!',document[_0x28da49(0x18a)](_0x28da49(0x12e))['textContent']=_0x2b232b[_0x28da49(0x1da)]['nama'],document['getElementById'](_0x28da49(0x159))['src']=_0x2b232b[_0x28da49(0x1da)][_0x28da49(0x164)];const _0x6b5967=Object[_0x28da49(0x150)](_0x2b232b[_0x28da49(0x1bc)])[_0x28da49(0x15d)](_0x2a316b=>_0x2b232b['academicYears'][_0x2a316b]['users'][_0x28da49(0x141)](_0x4606f6=>_0x4606f6[_0x28da49(0x179)]===_0x29dc0c[_0x28da49(0x179)]));_0x540326=_0x2b232b[_0x28da49(0x134)];const _0x4e614b=_0x6b5967[_0x28da49(0x137)]()[_0x28da49(0x1cb)]()[_0x28da49(0x1a3)](_0x2892ac=>{const _0xfbb3b2=_0x28da49,_0xbb744a=_0x2b232b[_0xfbb3b2(0x1bc)][_0x2892ac][_0xfbb3b2(0x101)]['find'](_0x5cf2fd=>_0x5cf2fd[_0xfbb3b2(0x179)]===_0x29dc0c['username']),_0x351c06=_0xbb744a?_0xbb744a[_0xfbb3b2(0x161)]:'N/A';return _0xfbb3b2(0x126)+_0x2892ac+'\x22\x20'+(_0x2892ac===_0x540326?_0xfbb3b2(0x198):'')+'>'+_0x2892ac+'\x20(Rombel\x20'+_0x351c06+_0xfbb3b2(0x108);})['join']('');document['getElementById'](_0x28da49(0xff))[_0x28da49(0x103)]=_0x4e614b,_0x5cae6a();}else _0x394340[_0x28da49(0xe4)]['display']=_0x28da49(0x17d),_0x558fe3['style'][_0x28da49(0x170)]=_0x28da49(0xfb);};_0xe9e3b8[_0x3c2f5a(0x1c1)](_0x3c2f5a(0x169),function(_0x4a3eb8){const _0x199415=_0x3c2f5a;_0x4a3eb8[_0x199415(0x17e)]();const _0xb708cb=document[_0x199415(0x18a)](_0x199415(0x179))[_0x199415(0x18b)],_0x3e86fa=document[_0x199415(0x18a)](_0x199415(0x132))[_0x199415(0x18b)],_0x2d1fb3=Object['values'](_0x2b232b['academicYears'])[_0x199415(0x19f)](_0x3e468a=>_0x3e468a[_0x199415(0x101)])['find'](_0x10a16f=>_0x10a16f[_0x199415(0x179)]===_0xb708cb&&_0x10a16f[_0x199415(0x132)]===_0x3e86fa);_0x2d1fb3?.[_0x199415(0x183)]===_0x199415(0x181)?(sessionStorage[_0x199415(0x1c5)](_0x199415(0x1c0),JSON['stringify'](_0x2d1fb3)),_0x1edb42()):document['getElementById'](_0x199415(0x138))[_0x199415(0x17a)]='Username,\x20Password,\x20atau\x20Role\x20salah!';}),_0x1edb42();}));function _0xb150(){const _0xdd6092=['subjects','absensiTable2','absences','utils','<th>','prestasiIndex','<select\x20class=\x22bulk-update-select\x22\x20data-type=\x22character\x22\x20data-character-name=\x22','change','<thead><tr><th\x20style=\x22width:10%;\x22>NISN</th><th\x20style=\x22width:20%;\x22>Nama\x20Siswa</th><th>Daftar\x20Prestasi</th><th\x20style=\x22width:10%;\x22>Aksi</th></tr></thead>','status','characterTables1','1034196xVynto','.sidebar-nav\x20a.nav-link','tingkat','</b>.','show','from','<tbody>','tahun','block','none','</select></th>','</td><td><button\x20class=\x22btn\x20btn-primary\x20action-btn\x22\x20data-action=\x22add-prestasi\x22\x20data-student-id=\x22','savePrestasiBtn','tahunPelajaranSelector','book_new','users','getItem','innerHTML','link','input,\x20select','<thead><tr><th>NISN</th><th>Nama\x20Siswa</th><th>Sakit</th><th>Izin</th><th>Alpha</th></tr></thead>','result',')</option>','querySelectorAll','open','absensiTable1','s_nisn','promotion','Data\x20prestasi\x20berhasil\x20disimpan.','excelUploadModal','button[data-action]','prestasiTableS1','</tbody></table></div></div>','studentId','</td>','\x22><i\x20class=\x22fa-solid\x20fa-trash\x22></i></button></div></li>','var(--danger-color)','masterSiswa','\x22><i\x20class=\x22fa-solid\x20fa-plus\x22></i>\x20Tambah</button></td></tr>','50968gGhbUC','nama','</tr></thead>','</tbody></table></div>','kegiatan','.page-section.active','Nilai','DOMContentLoaded','active','\x22\x20data-type=\x22promotion\x22\x20data-name=\x22status\x22><option\x20value=\x22\x22\x20','split','alpha','</td><td>','<option\x20value=\x22','<td><input\x20type=\x22number\x22\x20min=\x220\x22\x20max=\x22100\x22\x20value=\x22','prestasiKegiatan','semester2','prestasiTingkat','Tidak\x20Naik\x20Kelas','className','pageTitle','schoolName','Apakah\x20Anda\x20yakin\x20ingin\x20menghapus\x20prestasi\x20ini?','characterGradeOptions','Selamat\x20datang,\x20','password','<ul\x20class=\x22prestasi-list\x22>','activeYear','readAsArrayBuffer','Sheets','sort','errorMessage','\x22\x20data-type=\x22absence\x22\x20data-name=\x22sakit\x22\x20data-semester=\x22','<select\x20class=\x22bulk-update-select\x22\x20data-type=\x22extracurricular\x22\x20data-name=\x22','closest','find','Gagal\x20memproses\x20file.\x20Pastikan\x20format\x20file\x20benar.','28jtSIEi','loginScreen','2341800gMGKYF','some','prestasiTahun','Kegiatan\x20dan\x20Tahun\x20wajib\x20diisi!','\x22\x20data-type=\x22promotion\x22\x20data-name=\x22note\x22></td></tr>','appContainer','shortName','extracurriculars','click','outerHTML','edit-prestasi','<p\x20style=\x22text-align:center;\x22>Belum\x20ada\x20data\x20siswa.</p>','<thead><tr><th>NISN</th><th>Nama\x20Siswa</th>','Gunakan\x20menu\x20di\x20samping\x20untuk\x20mengelola\x20data\x20nilai\x20siswa.\x20Anda\x20saat\x20ini\x20mengajar\x20di\x20rombel\x20<b>','384948tKqVIZ','\x22\x20data-sub-name=\x22','keys','<thead><tr><th>NISN</th><th>Nama\x20Siswa</th><th>Status\x20Kenaikan</th><th>Catatan/Pesan</th></tr></thead>','parentNode','siswaTable2','location','book_append_sheet','\x22\x20data-student-id=\x22','replace','forEach','schoolLogo','\x22><option\x20value=\x22\x22>--Pilih--</option>','ekstraTables1','\x22\x20data-type=\x22subject\x22\x20data-name=\x22','filter','</h4><div\x20class=\x22table-wrapper\x22><table><thead><tr><th>NISN</th><th>Nama\x20Siswa</th>','kenaikanTable','643470tkCcMs','rombelAjar','\x22\x20data-index=\x22','contains','logoUrl','length','image/x-icon','\x22\x20data-type=\x22character\x22\x20data-character-name=\x22','prestasiModalTitle','submit','prestasiTableS2','welcomeMessage','55rknTZJ','.icon','.sidebar-nav\x20a.active','<li\x20class=\x22prestasi-item\x22><span\x20class=\x22prestasi-text\x22><strong>','display','downloadFormatBtn','notification','characterTables2','ekstraTables2','subValues','error','onload','enrollment','username','textContent','prestasiStudentId','has-submenu','flex','preventDefault','.bulk-update-select','Tambah\x20Prestasi','Guru','Aktif','role','home','join','prestasi','96aBBLoQ','grades','sheet_to_json','getElementById','value','dataset','Data\x20berhasil\x20disimpan.','7164bFoojL','File\x20terpilih:\x20','fileNameLabel','logoutBtn','nextElementSibling','edit','Edit\x20Prestasi','matches','characterValues','<p>Tidak\x20ada\x20data\x20nilai\x20karakter\x20untuk\x20diinput.</p>','selected','name','createElement','<li>Belum\x20ada\x20data\x20prestasi.</li>','>Tidak\x20Naik\x20Kelas</option></select></td><td><input\x20type=\x22text\x22\x20style=\x22width:\x20100%;\x20text-align:left;\x22\x20value=\x22','span','NISN','flatMap','read',':</strong>\x20','</tr>','map','\x22\x20data-type=\x22absence\x22\x20data-name=\x22izin\x22\x20data-semester=\x22','href','siswaTable1','subject','</b>\x20pada\x20Tahun\x20Pelajaran\x20<b>','extracurricular','add','Semua\x20nilai\x20di\x20kolom\x20ini\x20diupdate.','\x20data\x20siswa\x20berhasil\x20diimpor\x20dari\x20Excel.','</th>','</tbody>','\x22\x20data-type=\x22extracurricular\x22\x20data-name=\x22','array','[data-action=\x22close-modal\x22]','semester1','Prestasi\x20berhasil\x20dihapus.','</select></td>','prestasiJuara','.modal','91555xyBOIu','indexOf','querySelector','s_nama','.submenu.open','academicYears','\x22></td>','head','toggle','loggedInUser','addEventListener','Naik\x20Kelas','type','\x22\x20placeholder=\x22Cth:\x20Naik\x20ke\x20kelas\x202\x22\x20data-student-id=\x22','setItem','push','character','parse','loginForm','removeItem','reverse','</ul>','SheetNames','children','target','remove','izin','open-excel-modal','</tr></thead><tbody>','<tbody><tr><td\x20colspan=\x22100\x22\x20style=\x22text-align:center;\x22>Belum\x20ada\x20data\x20siswa.</td></tr></tbody>','<tr><td>','<td><select\x20data-student-id=\x22','Format-Nilai-Intra-','json_to_sheet','\x22\x20data-semester=\x22','schoolInfo',')</span><div\x20class=\x22prestasi-actions\x22><button\x20class=\x22btn\x20btn-warning\x20action-btn\x22\x20data-action=\x22edit-prestasi\x22\x20data-student-id=\x22','prestasiForm','classList','backgroundColor','juara','<td><input\x20type=\x22number\x22\x20min=\x220\x22\x20value=\x22','prestasiSemester','reload','</td><td\x20style=\x22white-space:\x20normal;\x22>','reset','style','\x22><option\x20value=\x22\x22>--\x20Set\x20Semua\x20--</option>','<div\x20class=\x22character-table-card\x22><h4>'];_0xb150=function(){return _0xdd6092;};return _0xb150();}
    </script>
</body>
</html>
